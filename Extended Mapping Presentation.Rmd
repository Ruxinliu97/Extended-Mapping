---
title: "Extended Mapping slides"
author: "Ruxin Liu, Jinzhe Zhang"
date: "11/12/2020"
output:
  revealjs::revealjs_presentation:
    theme: beige
    highlight: pygments
    css: reveal.css
    center: yes
    transition: slide
    html_document: 
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align='center')
library(knitr)
```

## Data Description 

- From the FEMA website
- The summary of Public Assistance Funded Projects & Preliminary Damage Assessment
- Interested in hurricanes being declared as disasters from year 2009 - 2018

## Total Project Amount (in dollars) from 2009 to 2018

```{r, echo = FALSE, message = FALSE}
library(tidyverse)
library(maps)
state <- map_data("state")
funding_sum <- read.csv("funding_sum.csv")
ggplot() + geom_polygon(data = funding_sum, aes(x = long, y = lat, group = group,
                                                fill = range), 
                        color = "grey", size = 0.2, alpha = 1.6) + 
  geom_polygon(data = state, aes(x = long, y = lat, group = group),
                 color = "black", fill = "white", size = 0.2, alpha = 0.3) +
      scale_fill_brewer(palette = "Blues") +
  ggtitle("Project Amount from 2009 to 2018") +
  # Center the title
  theme(plot.title = element_text(hjust = 0.5))
```

## Interactive map with plotly

```{r, message = FALSE, echo = FALSE, warning = FALSE}
library(plotly)
funding_year <- read.csv("funding_year.csv")
# Create hover on the map
funding_year$hover <- with(funding_year, paste("State:", state,"<br>","Project Number:",number,"<br>")) 
project_number <- plot_geo(funding_year, locationmode = 'USA-states') 
project_number <- project_number %>% add_trace(
  locations = ~stateCode,
  type = 'choropleth',
  z = ~number,
  text = ~hover,
  colorscale = "Blues"
)
# Add title
project_number <- project_number %>% layout(
  title = 'Number of Hurricane Project from 2009 - 2018'
)

project_number
```

## Statewide per capita impact (in dollars)

```{r, message = FALSE, echo = FALSE, warning = FALSE}
# Load the data in 
assistance <- read.csv("FEMA.csv")
ggplot(data = assistance, aes(Year, Statewide_per_capita_impact))+
  geom_point(aes(color = State), alpha=0.5)+
  labs(title = "Year vs Per Capita Assistance", 
       y = "Statewide per capita impact ($)", x = "Year")+
  theme(plot.title = element_text(size = 20),
        axis.text = element_text(size =  14),
        axis.title.x = element_text(size = 16),
        axis.title.y = element_text(size = 16))
```


## Reference 
1. Hadley Wickham, Romain François, Lionel Henry and Kirill Müller (2020). 
dplyr: A Grammar of Data Manipulation. R package version 1.0.2. https://CRAN.
R-project.org/package=dplyr
2. Original S code by Richard A. Becker, Allan R. Wilks. R version by Ray Brownrigg.
Enhancements by Thomas P Minka and Alex Deckmyn. (2018). maps: Draw Geographical 
Maps. R package version 3.3.0. https://CRAN.R-project.org/package=maps
3. Wickham et al., (2019). Welcome to the tidyverse. Journal of Open Source 
Software, 4(43), 1686, https://doi.org/10.21105/joss.01686
4. C. Sievert. Interactive Web-Based Data Visualization with R, plotly, and shiny.
Chapman and Hall/CRC Florida, 2020.
5. FEMA: https://www.fema.gov/openfema-data-page/public-assistance-funded-projects-details-v1
6. FEMA: https://www.fema.gov/disasters/disaster-declarations?field_dv2_state_territory_tribal_value=All&field_year_value=All&field_dv2_declaration_type_value=All&field_dv2_incident_type_target_id_selective=49124

